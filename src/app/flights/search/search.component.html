<div class="search-container">
  <section class="search-section">
    <h2>Find Your Flight</h2>
    <p class="info-message">Not sure where to go? Just leave the destination blank and we'll find one for you!</p>

    <form (ngSubmit)="onSearch()" [formGroup]="searchForm" class="search-form">
      <div class="form-group">
        <label for="from">From</label>
        <select id="from" formControlName="from">
          <option value="" disabled selected>Select departure</option>
          <ng-container *ngFor="let country of groupedLocations | keyvalue">
            <optgroup [label]="country.key">
              <option *ngFor="let city of country.value" [value]="city.name" [disabled]="city.name === searchForm.get('to')?.value">
                {{ city.name }} ({{ country.key }})
              </option>
            </optgroup>
          </ng-container>
        </select>
      </div>

      <div class="form-group">
        <label for="to">To</label>
        <select id="to" formControlName="to">
          <option value="" selected>Select destination (Optional)</option>
          <ng-container *ngFor="let country of groupedLocations | keyvalue">
            <optgroup [label]="country.key">
              <option *ngFor="let city of country.value" [value]="city.name" [disabled]="city.name === searchForm.get('from')?.value">
                {{ city.name }} ({{ country.key }})
              </option>
            </optgroup>
          </ng-container>
        </select>
      </div>
      <div class="form-group">
        <label for="number_of_persons">Passengers</label>
        <input id="number_of_persons" type="number" formControlName="number_of_persons" min="1" />
      </div>

      <div class="form-group">
        <label for="period_start">Travel Start</label>
        <input id="period_start" type="date" formControlName="period_start" [min]="today" />
      </div>

      <div class="form-group">
        <label for="period_end">Travel End</label>
        <input id="period_end" type="date" formControlName="period_end" [min]="searchForm.get('period_start')?.value || today" />
      </div>

      <div class="form-group">
        <label for="duration">Duration (days)</label>
        <input id="duration" type="number" formControlName="duration" min="1" />
      </div>

      <div class="form-group">
        <label for="return_flight">Return Flight</label>
        <input id="return_flight" type="checkbox" formControlName="return_flight">
      </div>

      <button type="submit" [disabled]="searchForm.invalid">Search</button>
    </form>
  </section>

  <section class="results-section" *ngIf="searchResults && searchResults.length > 0">
    <h2>Search Results</h2>
    <div *ngFor="let result of searchResults" class="result-container">
      <div class="result-summary">
        <p><strong>Total Price:</strong> {{ result.total_price | currency }}</p>
        <p><strong>Total Duration:</strong> {{ result.total_duration }} hours</p>
      </div>

      <!-- Outbound Flights -->
      <div class="flight-group">
        <h3>Outbound Flights</h3>
        <div *ngFor="let flight of result.outbound" class="flight-details">
          <p><strong>From:</strong> {{ flight.from }}</p>
          <p><strong>To:</strong> {{ flight.to }}</p>
          <p><strong>Price:</strong> {{ flight.price | currency }}</p>
          <p><strong>Duration:</strong> {{ flight.duration }} hours</p>
        </div>
      </div>

      <!-- Return Flights -->
      <div class="flight-group">
        <h3>Return Flights</h3>
        <div *ngFor="let flight of result.return" class="flight-details">
          <p><strong>From:</strong> {{ flight.from }}</p>
          <p><strong>To:</strong> {{ flight.to }}</p>
          <p><strong>Price:</strong> {{ flight.price | currency }}</p>
          <p><strong>Duration:</strong> {{ flight.duration }} hours</p>
        </div>
      </div>
    </div>
  </section>
</div>
